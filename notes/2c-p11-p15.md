# Computer Networks Problems - Solutions P11-P15

## Table of Contents
- [P11. Sharing Link with Parallel Connections](#p11-sharing-link-with-parallel-connections)
- [P12. TCP Server Program](#p12-tcp-server-program)
- [P13. HTTP/2 Frame Interleaving](#p13-http2-frame-interleaving)
- [P14. HTTP/2 with Prioritization](#p14-http2-with-prioritization)
- [P15. MAIL FROM vs From in Email](#p15-mail-from-vs-from-in-email)

---

## P11. Sharing Link with Parallel Connections

**Given:**
- Bob shares link with 4 other users (5 users total)
- Bob uses parallel instances of non-persistent HTTP
- Other 4 users use non-persistent HTTP without parallel

### a. Do Bob's parallel connections help him get pages more quickly?

**Answer: YES, Bob benefits from parallel connections**

**Explanation:**

Assuming fair sharing of bandwidth:
- **Without coordination:** Each TCP connection gets equal share
- If Bob opens N parallel connections while others each open 1:
  - Total connections: N (Bob) + 4 (others) = N + 4
  - Bob's share: N/(N+4) of total bandwidth
  - Each other user's share: 1/(N+4) of total bandwidth

**Example with N=5:**
- Total connections: 5 + 4 = 9
- Bob gets: 5/9 ≈ 55.6% of bandwidth
- Each other user gets: 1/9 ≈ 11.1% of bandwidth

**Bob downloads faster because:**
1. He gets more aggregate bandwidth
2. Multiple objects download in parallel
3. TCP slow-start affects each connection, but with more connections, Bob overcomes this faster

**Ethical consideration:** Bob is being "greedy" and getting unfair advantage

### b. If all 5 users open 5 parallel instances, would Bob's parallel connections still be beneficial?

**Answer: NO, Bob gains no advantage**

**Explanation:**

When all users use same strategy:
- Total connections: 5 × 5 = 25
- Each user opens 5 connections
- Each user gets: 5/25 = 1/5 = 20% of total bandwidth

**Result:**
- **Fair distribution:** Each user gets equal share (20%)
- Bob has no advantage over others
- All users experience:
  - More overhead from managing multiple connections
  - More complexity
  - Same overall throughput

**Additional problems when all use parallel connections:**
- Increased congestion
- More packet loss
- More TCP retransmissions
- Network operates less efficiently

**Conclusion:** Parallel connections only help when others don't use them. When everyone uses them, it becomes a "tragedy of the commons" situation with no individual benefit and collective harm.

---

## P12. TCP Server Program

**Answer:**

```python
# TCPServer.py - Modified to display HTTP GET requests
from socket import *

serverPort = 12000
serverSocket = socket(AF_INET, SOCK_STREAM)
serverSocket.bind(('', serverPort))
serverSocket.listen(1)
print('The server is ready to receive')

while True:
    connectionSocket, addr = serverSocket.accept()
    try:
        message = connectionSocket.recv(4096).decode()
        print('='*50)
        print('Received from:', addr)
        print(message)
        print('='*50)
        
        # Send a simple HTTP response
        response = 'HTTP/1.1 200 OK\r\n\r\n'
        connectionSocket.send(response.encode())
    except:
        pass
    finally:
        connectionSocket.close()
```

**Testing for Conditional GET:**

To test if browser generates conditional GET messages:

1. Run the server program
2. Configure browser proxy to point to your server (e.g., localhost:12000)
3. Visit a webpage multiple times
4. Check server output for these headers:

**First request:**
```
GET /page.html HTTP/1.1
Host: example.com
```

**Subsequent request (conditional GET):**
```
GET /page.html HTTP/1.1
Host: example.com
If-Modified-Since: Wed, 21 Oct 2015 07:28:00 GMT
If-None-Match: "686897696a7c876b7e"
```

**Indicators of Conditional GET:**
- `If-Modified-Since` header present
- `If-None-Match` header present (with ETag)

Most modern browsers **DO generate conditional GET** messages for cached objects to validate freshness.

---

## P13. HTTP/2 Frame Interleaving

**Given:**
- 1 video clip: 2000 frames
- 5 images: 3 frames each (total 15 frames)
- Total frames: 2015

### a. If all video frames sent first without interleaving

**Answer: 2000 frame times**

**Explanation:**
- Video frames: 1, 2, 3, ..., 2000
- Images start after video completes
- First image frame sent at time 2001
- Last image frame sent at time 2015

**Time until all 5 images are sent: 2000 + 15 = 2015 frame times**
**Time until all 5 images START being sent: 2000 frame times**

### b. If frames are interleaved

**Answer: 15 frame times**

**Explanation:**

With optimal interleaving (round-robin):
- Frame 1: Video frame 1
- Frame 2: Image 1, frame 1
- Frame 3: Image 2, frame 1
- Frame 4: Image 3, frame 1
- Frame 5: Image 4, frame 1
- Frame 6: Image 5, frame 1
- Frame 7: Video frame 2
- Frame 8: Image 1, frame 2
- ...
- Frame 15: Image 5, frame 3 ✓ (all images complete)

**Time until all 5 images sent: 15 frame times**

**Benefit:** Dramatic improvement! 2000 → 15 frame times

---

## P14. HTTP/2 with Prioritization

**Given:**
- All images prioritized over video
- Image 1 > Image 2 > Image 3 > Image 4 > Image 5 > Video
- Each image: 3 frames

**Question:** How many frame times until second image is sent?

**Answer: 6 frame times**

**Explanation:**

Priority order (highest to lowest):
1. Image 1 (3 frames)
2. Image 2 (3 frames) ← **We want to know when this completes**
3. Image 3 (3 frames)
4. Image 4 (3 frames)
5. Image 5 (3 frames)
6. Video (2000 frames)

**Frame schedule:**
- Frames 1-3: Image 1 (frames 1, 2, 3)
- Frames 4-6: Image 2 (frames 1, 2, 3) ✓ **Complete**

**Answer: 6 frame times** until the second image is completely sent.

---

## P15. MAIL FROM vs From in Email

**Answer:**

### MAIL FROM: (SMTP Protocol Command)
- **Purpose:** Part of the **SMTP envelope**
- **Used by:** Mail servers for routing and delivery
- **Format:** `MAIL FROM:<sender@example.com>`
- **Function:** 
  - Tells receiving server where to send bounce messages
  - Used for return-path in case of delivery failure
  - Part of the actual SMTP protocol handshake
- **Visibility:** Not typically seen by end users
- **Can be different from:** The From: header in the message

### From: (Email Header)
- **Purpose:** Part of the **message content** (email headers)
- **Used by:** Email clients to display sender to recipient
- **Format:** `From: John Doe <john@example.com>`
- **Function:**
  - Shows who the message is purportedly from
  - Displayed in email client
  - Part of the message itself (like Subject, To, Date)
- **Visibility:** Always visible to end users

### Key Differences:

1. **Layer:**
    - MAIL FROM: Envelope (transport layer)
    - From: Message header (content layer)

2. **Analogy:**
    - MAIL FROM: Return address on outside of postal envelope
    - From: Return address on letter inside envelope

3. **Spoofing:**
    - From: Can be easily forged
    - MAIL FROM: Also can be forged but used for routing
    - This discrepancy is often exploited in phishing/spam

4. **Bounce handling:**
    - MAIL FROM: Receives bounce notifications
    - From: May never know about bounces

**Example of legitimate difference:**
- Mailing list: MAIL FROM: <list-bounces@mailinglist.com>
- Message From: <member@example.com>